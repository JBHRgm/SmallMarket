<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>SmallMarket</title>

</head>

<body>
    <h1>Homepage</h1>
    <div style="display: flex;" id="bodywrapper">
      <div>
        <h2>Kategorien:</h2>
        <form method="GET" id="searchform">
        <% for (x = 0; x < categories.length; x++) { %>
          <% if (categories[x]['parent'] == 0) { %>
            <% if (x > 0) { %>
            </ul>
            <% } %>
            <h3><%=categories[x]['name']%> (<%=categories[x]['count']%>)
              <% if (cat.includes(categories[x]['id'].toString())) { %>
              <input type="checkbox" value="<%=categories[x]['id']%>" name="cat" checked>
              <% } else { %>
              <input type="checkbox" value="<%=categories[x]['id']%>" name="cat">
              <% } %>
            </h3>
            <ul>
          <% } else { %>
            <li><%=categories[x]['name']%> (<%=categories[x]['count']%>)
              <% if (cat.includes(categories[x]['id'].toString())) { %>
              <input type="checkbox" value="<%=categories[x]['id']%>" name="cat" checked>
              <% } else { %>
              <input type="checkbox" value="<%=categories[x]['id']%>" name="cat">
              <% } %>
            </li>
          <% } %>
          <% if (x == categories.length - 1) { %> </ul> <% } %>
        <% } %>
        <h2>Preis:</h2>
        <div style="display: inline-block;">
          <input type="number" name="pl" id="pl" min="0" max="9999999" value="<%=price[0]%>">
          <input type="number" name="ph" id="ph" min="1" max="10000000" value="<%=price[1]%>">
        </div>
        <h2>Ergebnisse in:</h2>
        <ul>
          <% for (x = 0; x < locations.length; x++) { %>
            <li><%=locations[x]['name']%> (<%=locations[x]['count']%>)
              <% if (loc.includes(locations[x]['address'])) { %>
              <input type="checkbox" value="<%=locations[x]['address']%>" name="loc" checked>
              <% } else { %>
              <input type="checkbox" value="<%=locations[x]['address']%>" name="loc">
              <% } %>
            </li>
          <% } %>
        </ul>
      </div>
      <div style="margin-left: 20px;">
        <div>
            <input type="text" name="search" id="search" value="<%=locals.search%>">
            <input type="radio" name="order" value="date-a" <% if (order == 'date-a') { %> checked <% } %>>Neueste zuerst
            <input type="radio" name="order" value="date-d" <% if (order == 'date-d') { %> checked <% } %>>Älteste zuerst
            <input type="radio" name="order" value="price-a" <% if (order == 'price-a') { %> checked <% } %>>Günstigste zuerst
            <input type="radio" name="order" value="price-d" <% if (order == 'price-d') { %> checked <% } %>>Teuerste zuerst
            <button type="submit" id="searchsubmit">Suchen</button> 
          </form>
          <p><%=count%> Einträge gefunden</p>
        </div>
        <br>
        <div>
          <% for (x = 0; x < articles.length; x++) { %>
            <div style="display: flex; justify-content: space-around;" id="article<%=articles[x]['id']%>">
              <% if (articles[x]['picture']) { let folder = articles[x]['picture'].split('pic').shift(); %>
                <img src="/static/img/articles/<%=folder + '/' + articles[x]['picture']%>" width="400px" height="300px">
              <% } else { %>
                <img src="/static/img/articles/no-image-found.png" width="400px" height="300px">
              <% } %>
              <div>
                <h3><%=articles[x]['title']%></h3>
                <p><%=articles[x]['description']%></p>
                <%=articles[x]['created']%>
              </div>
              <div>
                <p><%=articles[x]['name']%></p>
                <p><%=articles[x]['address']%></p>
                <p style="color: red; font-size: medium;"><%=articles[x]['price'].toFixed(2)%> €</p>
              </div>
            </div>
          <% } %>
        </div>
      </div>
    </div>
    
    
    
</body>
<script src="/static/js/jquery-3.3.1.min.js"></script>
<script>
  $(() => {

  })
</script>

</html>